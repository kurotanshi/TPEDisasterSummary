<html>
<head>
  <title>公車路線圖</title>
  <meta charset="utf-8">
  <style>
    html, body {
      height: 100%; margin: 0; padding: 0;
    }
    #map{
      position: relative; width: 100%; height: 100%; z-index: 2;
    }
    #zone{
      position: absolute; z-index: 5; top: 10px; left: 10px;
      width: 300px; height: 100px; background-color: #fff; border: 1px solid #000;
    }
    #zone textarea{
      width: 200px; height: 100px;
    }
    #zone button{
      position: absolute; right: 30px; top: 40px; font-size: 1em;
    }
  </style>
</head>
<body>

<div id="zone">
  <textarea>121.569962930445 25.0238569702231,121.569406055845 25.0248674502727,121.568873446752 25.0257821201488,121.568430184406 25.0266604385284,121.568422988031 25.026780518706,121.568365609485 25.0287188284112,121.568338080338 25.0306331280165,121.56834156701 25.0319268918126,121.568338424779 25.0326388131307,121.568403806391 25.0328579806114,121.568456179309 25.035851567396,121.565504151096 25.0359155892331,121.565585850007 25.0389665959317,121.56559759875 25.0391074189723,121.564672930212 25.0391540515183,121.563675735847 25.0391437551802,121.563674945343 25.039337488934,121.563705482722 25.0395492127261,121.563812949008 25.0397640679574,121.563951895164 25.0399893184523,121.564247789204 25.0404678171361,121.564488418106 25.0408759034003,121.564494845561 25.0410202014212,121.564544215643 25.0411310158837,121.566034984027 25.0410731364162,121.568281673061 25.0410146139333,121.569750138258 25.0409806591302,121.571822252695 25.0409160770154,121.574216281256 25.0408727593704,121.576744482372 25.0407964240158,121.577905879453 25.0407953106551,121.577889055835 25.0417865029448,121.577877114637 25.0433804145745,121.577848741027 25.0446803432233,121.577860353972 25.0457144457651,121.577861574352 25.0472783964809,121.577870050462 25.0479899104061,121.578781871286 25.0480403120109,121.579377073193 25.0481294240337,121.580045394479 25.0483075671406,121.580085046488 25.0480860326443,121.580158164967 25.0478745049045,121.580263449499 25.0477343149867,121.580409973342 25.0476184229519,121.580528283653 25.0474312074843,121.580589033757 25.0472577255636,121.580592144512 25.0470766074995,121.580621876998 25.0458800828995,121.58064113508 25.0452688568723,121.58099392473 25.0452659862363,121.581727231926 25.045302743327,121.582432912849 25.0452676589753,121.582562417022 25.0452591316037,121.582723210408 25.0452231623191,121.582810861032 25.0451692335733,121.582985911371 25.0451170953777,121.583159841154 25.0451103414691,121.583355371753 25.0450773408467,121.583603563054 25.0450736266466,121.583882323211 25.0450832997545,121.584043945772 25.0451666012577,121.584189963296 25.0452156286984,121.585258395658 25.0457678376156,121.58586912526 25.0460137122631,121.586679108654 25.0462733879066,121.58713701646 25.0463872798491,121.58762000456 25.0464644434794,121.588310454564 25.0465427609397,121.588813513733 25.0465556877948,121.58919521119 25.0465623445766,121.589442419532 25.0465589829108,121.589812554406 25.0465065011741,121.590211942427 25.0464160698458,121.591226548566 25.046173729534,121.592141231033 25.0459632764841,121.592335204007 25.0459430120604,121.592536895861 25.0458291192185,121.592663947583 25.045740642117,121.592680237903 25.045638550179,121.592629746366 25.0454082517895,121.592598193652 25.0451613321299,121.592617940066 25.0449430190052,121.592681959205 25.0446740722507,121.59281841244 25.0444413528862,121.592916876513 25.0442207392957,121.592874899757 25.0440816339603,121.592744466584 25.0438291771748,121.592697825944 25.0436716222476,121.592688129454 25.0435012007199,121.592947097331 25.0423274271691,121.593016919795 25.0420326258051,121.5931327192 25.0417600278031,121.593222496721 25.0414683183083,121.593274228423 25.041135772398,121.593276545077 25.0410156103821,121.593049453669 25.0406516367637,121.592950503963 25.0404635048869,121.592932043579 25.0403875238652,121.592808653896 25.0402114842726,121.592627429712 25.0400462779135,121.592417645758 25.0400236833464,121.592266541668 25.0400567613106,121.59207989637 25.0401683680758,121.591942953005 25.0404635687387,121.591608376425 25.0411488737216,121.591532376518 25.0412749892494,121.591387814996 25.041337060457,121.591141574324 25.0413374966282,121.590949082534 25.0413221631873,121.590830252414 25.0412468359727,121.590752612143 25.0411095724489,121.590739196956 25.0409394782744,121.590726790809 25.0407263380501,121.590625298719 25.0403803985366,121.590927764105 25.0401789683847,121.591118819678 25.0400081394641,121.591326495621 25.0393891927571,121.591350429279 25.0391431175609,121.591432841353 25.0388957095694,121.591604674816 25.0387503782274,121.591970361643 25.0387351724902,121.5928855873 25.0388240138172,121.593251750768 25.038873454946,121.593391556675 25.0389893694639,121.593453314919 25.0391087238885,121.593501504191 25.0393468220982,121.593506150988 25.0396298378468,121.593482949379 25.0398377314262,121.59295463275 25.0403800469017,121.593114766034 25.0406143265899,121.593332875012 25.0410179495188,121.593342186593 25.04112275651,121.59328097064 25.04149293635,121.593197150228 25.04176516563,121.593006475968 25.0423472005629,121.592761625649 25.043510916096,121.592763204858 25.0436681769448,121.592816781969 25.0437926575052,121.592965841001 25.0441371194325,121.592974510465 25.0442624876238,121.592881265158 25.04447339663,121.59274967186 25.0447127835682,121.59269280323 25.0449318071572,121.592673682744 25.0451696418655,121.592703755174 25.0454113643431,121.592752073949 25.0456397121031,121.592731101759 25.0457580071264,121.592595448022 25.0458830812393,121.592353672484 25.045988219181,121.592121338929 25.0460223142784,121.591253316887 25.0462212757913,121.590246946739 25.0464682835845,121.589844163777 25.0465708305794,121.589469380308 25.0466217403011,121.589221144041 25.0466188786584,121.588847762614 25.0466119439861,121.58830877463 25.0465981052184,121.587609831429 25.0465276667185,121.587120245903 25.0464371508539,121.586671936561 25.0463178422946,121.585847802334 25.0460665789095,121.585226629805 25.0458175845139,121.584172264638 25.0452644924624,121.584031280619 25.0452178527217,121.583870092431 25.0451354118698,121.583607448125 25.0451104134149,121.583354963461 25.0451268188477,121.583150470218 25.0451521356626,121.583004423915 25.0451658053577,121.58283699713 25.0452050391813,121.582769101913 25.045284653464,121.582617624604 25.0453642056936,121.582413750994 25.0453655600726,121.5816100026 25.0453899694716,121.580759005624 25.0454077364779,121.580724824191 25.0459946367432,121.580716711407 25.0470536999683,121.580708197525 25.0472814173036,121.580660751093 25.0475185613326,121.580548488722 25.0477397289054,121.580427040675 25.0478343627657,121.580338538393 25.0479478158391,121.580263695014 25.0480737542005,121.580242033043 25.0482738182822,121.580232672 25.0483945675553,121.580251873425 25.0484863775444,121.57935903639 25.0482394147173,121.578816619292 25.0481283448473,121.578410253431 25.0481114555793,121.57786744063 25.0480929277465,121.577706132832 25.0480827276358,121.577678739482 25.0472850910342,121.577741640764 25.0456972867005,121.577732125937 25.044667748218,121.577757154969 25.0433529609704,121.57776186202 25.0417789783173,121.577761949255 25.0408857482787,121.576801559644 25.0408908366429,121.574241455978 25.040970343007,121.571796779398 25.041033317134,121.569688314364 25.0410882153489,121.56840600883 25.0411245020941,121.568375892334 25.0398611758527,121.568368170755 25.0392903527676,121.568365803739 25.0390563248895,121.565517640027 25.0391067399841,121.565512759406 25.038901904999,121.565415930301 25.0358471562213,121.568302454595 25.035780922052,121.568218797859 25.0328288470737,121.56827794627 25.0326249617726,121.568266203822 25.0320530415147,121.568272222985 25.0319164605763,121.568256119724 25.0306466825984,121.568294750103 25.0289358815857,121.568289144628 25.0286355314047,121.568340093021 25.0267599296271,121.568376195405 25.0266317474572,121.568816442325 25.0257853028495,121.569350457957 25.02485794264,121.569913655691 25.0238349773024</textarea>
  <button>Build</button>
</div>

<div id="map"></div>


<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyCogdyMaKSdYambuOPMJikTcz6y8GFoLSA&libraries=drawing,places"></script>

<script src="https://code.jquery.com/jquery-1.12.1.min.js"></script>
<script src="https://npmcdn.com/@turf/turf/turf.min.js"></script>


<script type="text/javascript">

// (function(){

var map;
var dataMap = new google.maps.Data();
var geojson = null;


map = new google.maps.Map(document.getElementById('map'), {
  zoom: 12,
  center: new google.maps.LatLng(25.050057, 121.498283),
  mapTypeId: google.maps.MapTypeId.TERRAIN
});

map.data.setStyle({
  strokeColor: 'red',
  strokeWeight: 4,
  strokeOpacity: 1,
  visible: true
});


$('#zone button').on('click', function(e){
  e.preventDefault();
  var coods = $.trim($('#zone textarea').val());
  coods = coods.split(',');
  coods = coods.map(function(d){
    var tmp = d.split(' ');
    return [parseFloat(tmp[0]), parseFloat(tmp[1])];
  });

  var path = turf.lineString(coods);
  var centroidPt = turf.centroid(path);

  if( geojson ){
    for (var i = 0; i < geojson.length; i++) map.data.remove(geojson[i]);
  }

  map.panTo( new google.maps.LatLng(centroidPt.geometry.coordinates[1], centroidPt.geometry.coordinates[0]) );
  map.setZoom(14);
  geojson = map.data.addGeoJson(path);
});

// })();
</script>

</body>
</html>